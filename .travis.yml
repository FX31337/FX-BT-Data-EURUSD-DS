language: python
python:
- '3.4'
env:
  global:
    - pair=EURUSD
  matrix:
    - FORMAT=hst
    - FORMAT=fxt
addons:
  apt:
    packages:
    - realpath
    - pv
notifications:
  email: false
before_install:
- env
- free -m
install: 
before_script:
- PATH=${PATH//:\.\/node_modules\/\.bin/}
- curl -o Makefile https://raw.githubusercontent.com/FX31337/FX-BT-Data-Test/master/Makefile
script:
- set -e
- make $FORMAT
after_success: 
after_failure:
- sudo apt-get -qy install tree && - tree -d -L 6
- env
after_script:
- pwd
deploy:
  provider: releases
  api_key:
    secure: wZfruJ+KVDfyOGnJbhE2PiYmcHoSY470hQEumXeQ+pFnv+803xXmKBJ/VmCZtbbbVR0hxuucsgpM7srCn5Emz2PkpiCUKwaXTKZqnk+L3BVHdlP2gY0wZoHKRh5znNeYB24XyANlE5IEUAot7B5vmBj6Yo/F0zirIm8hltjFryqQhSNWyGyzhoE4Mkpp2Xwlqr4SqHhkgHSN/WphLsbmZGWHVSYpJAot4nGHlxwZF0Xw0RIRSmO3wCWCHVQIYI5AOOjZJre9t+WaKHfOqlmvrqgw1y6PzLSAtcApUFJoy7DGNTkpQTTuXpU+MuDoacUyaelMbXxGQm68fxtZx4gtEv3iCWjlRQFkYMqjYpaf5FkgW/a9L2Y+DiW/f1QeJzstyZn3Im6MrL9wPat7V+VhhRTv1+Fnpj1+hqTuKydtOtBVvCAPwDZO0jjXINjkhzEMwLP1toHSkGP6G10G4ZP2CMTtxcCXSvoZpeGroZm6dgNKA/yeLwYzg/TrQBM5152EcKtyOH5Tv5Vs7MHEUKT+cZ249cpLmWH0DSg2Hws9gQk129QAKBzG/36ENLalhrC8uCl5agxFOyfd79SvI8aevrMZgPIYJ2UZELVGD7wplIiMHMhbqXlThRt7gfrnzCBGhP4foCaHG9DtKlqJEDumZNpfCtI/YHYyx6chEtTpgpk=
  file:
    - "${pair}1.hst.gz"
    - "${pair}5.hst.gz"
    - "${pair}15.hst.gz"
    - "${pair}30.hst.gz"
    - "${pair}60.hst.gz"
    - "${pair}240.hst.gz"
    - "${pair}10080.hst.gz"
    - "${pair}43200.hst.gz"
    - "${pair}1_0.fxt.gz"
    - "${pair}5_0.fxt.gz"
    - "${pair}15_0.fxt.gz"
    - "${pair}30_0.fxt.gz"
    - "${pair}60_0.fxt.gz"
    - "${pair}240_0.fxt.gz"
    - "${pair}10080_0.fxt.gz"
    - "${pair}43200_0.fxt.gz"
  on:
    repo: FX31337/FX-BT-Data-EURUSD-DS
    tags: true
after_deploy:
- make clean
